Uker.busicon=L.icon({iconUrl:Uker.URL+"/css/images/bkkS.png",iconSize:[20,20],shadowSize:[0,0],iconAnchor:[10,20],shadowAnchor:[0,0],popupAnchor:[0,-7]}),Uker.busiconOver=L.icon({iconUrl:Uker.URL+"/css/images/bkkL.png",iconSize:[32,32],shadowSize:[0,0],iconAnchor:[16,32],shadowAnchor:[0,0],popupAnchor:[0,-24]}),Uker.Pt={Options:{pton:!0},stops:[],legend:null,routes:[],openmarker:[],_markers:[],preload:function(o){$(o).each((function(){$("<img/>")[0].src=this}))},init:function(){Uker.log.log("pt init.v20220712"),Uker.Pt.preload([Uker.URL+"/css/images/bkkL.png",Uker.URL+"/css/images/bkkS.png"]),$(".poi").after('\n                <div id="ptpanel" style="filter: drop-shadow(0px 0px 16px rgba(0, 0, 0, 0.25))">\n                    <div class="ptactive" style="padding-right: 10px;margin-top: 10px;border-radius: 5px;padding: 12px 16px 1px 16px;background-color: #fefefe;font-weight: bold;font-size: 14px;">'.concat(Uker.lang.pt_nearby_details,'</div>\n                    <div class="" style="margin-top: 4px;border-radius: 5px;padding: 0px 0px 12px 12px;background-color: #fefefe;font-weight: bold;font-size: 12px;">\n                    <label class="uk-icom-switch">\n                    <input type="checkbox" id="pt">\n                    <span class="uk-icom-slider uk-icom-round" id="ptslider"></span>\n                    </label> <span class="ptactive" style="padding-right: 10px;font-size: 12px;font-weight: normal;vertical-align: text-top;">').concat(Uker.lang.show_on_map,"</span>\n                    </div>\n                </div>\n            ")),$("#pt").prop("checked",Uker.Pt.Options.pton),$("#pt").change((function(){Uker.Pt.setPton($("#pt").prop("checked")),$(this).prop("checked")?Uker.mapInteractionEvent("checked","bkk"):Uker.mapInteractionEvent("unchecked","bkk")})),Uker.log.log("pt init 86"),Uker.Map.mapOptions.zoom<15?$(".ptactive").css("opacity","0.5"):$(".ptactive").css("opacity","1.0"),Uker.Pt.getStops(),Uker.mymap.on("moveend",(function(){Uker.Map.mapOptions.zoom<15?$(".ptactive").css("opacity","0.5"):$(".ptactive").css("opacity","1"),Uker.Pt.getStops()})),Uker.mymap.on("moveend",(function(){})),Uker.mymap.on("popupopen",(function(o){var e=o.popup._source;Uker.log.log("popup nyílik"),Uker.log.log("pt86: "+e.options.oid),Uker.Map.autoopeopopupid=e.options.oid,Uker.log.log(Uker.Map.autoopeopopupid)})),Uker.mymap.on("popupclose",(function(o){var e=o.popup._source;Uker.log.log("popup nyílik"),Uker.log.log("pt86: "+e.options.oid),Uker.Map.autoopeopopupid=null,Uker.Map.openmarker=[],Uker.log.log(Uker.Map.autoopeopopupid)}))},deinit:function(){Uker.log.log("deinit:pt deinit"),$("#ptpanel").detach(),Uker.Pt.Options.pton=!1,Uker.Pt.getStops()},setPton:function(o){Uker.Pt.Options.pton=o,o?($("#pt").addClass("uk-right-0 "),$("#pt_toggle_helper").removeClass("uk-bg-gray-300").addClass("uk-bg-blue-300")):($("#pt").removeClass("uk-right-0"),$("#pt_toggle_helper").removeClass("uk-bg-blue-300").addClass("uk-bg-gray-300")),Uker.Pt.getStops()},removeMarkers:function(){Uker.log.log("removeMarkers:remove  popupipd: "+Uker.Map.autoopeopopupid),Uker.log.log(Uker.Pt._markers.length),Uker.log.log(Uker.Pt._markers),Uker.Pt.openmarker=[],Uker.Pt._markers.forEach((function(o){o.options.oid!=Uker.Map.autoopeopopupid?Uker.mymap.removeLayer(o):(Uker.log.log("nem törlöm: "+Uker.Map.autoopeopopupid+" oid:"+o.options.oid),Uker.Pt.openmarker=[o])})),Uker.log.log("Uker.Pt.openmarker"),Uker.log.log(Uker.Pt.openmarker),Uker.log.log("Uker.Pt.openmarker vege"),Uker.Pt._markers=Uker.Pt.openmarker},openPopup:function(){Uker.log.log("openPopup "+Uker.Map.autoopeopopupid),Uker.Pt._markers.forEach((function(o){if(Uker.log.log("openPopup: foreach:"+o.options.oid+" =? "+Uker.Map.autoopeopopupid),o.options.oid===Uker.Map.autoopeopopupid)return Uker.log.log("haho, nyitom"),void o.openPopup()}))},openPreviuosPopup:function(){},setStops:function(o){Uker.Pt.removeMarkers(),0==Uker.Pt.Options.pton&&Uker.mymap.isFullscreen()||(Uker.Pt.stops=o,Uker.Pt.stops.forEach((function(o){if(Uker.Map.autoopeopopupid!="s"+o.lat+"s"+o.lon+"n"+o.name){var e=o.routes,p=L.marker([o.lat,o.lon],{icon:Uker.busicon,oid:"s"+o.lat+"s"+o.lon+"n"+o.name}).bindPopup(L.responsivePopup({autoPanPadding:[20,45],autoPanSpeed:45,autoClose:!1,minWidth:180,closeButton:!1}).setContent(Uker.Template.routebubi(e,o))).addTo(Uker.mymap);p.on("mouseover",(function(o){var e=o.target;e.setIcon(Uker.busiconOver),e.setZIndexOffset(3e3)})),p.on("click",(function(o){o.target.setIcon(Uker.busiconOver)})),p.on("mouseout",(function(o){var e=o.target;o.target.isPopupOpen()||e.setIcon(Uker.busicon),e.setZIndexOffset(0)})),p.on("popupclose",(function(o){var e=o.target;e.setIcon(Uker.busicon),e.setZIndexOffset(0)})),Uker.Pt._markers.push(p)}else Uker.log.log("nem tettük ki: "+Uker.Map.autoopeopopupid)})),Uker.Pt.computedroutes(),Uker.Pt.openPreviuosPopup())},go:function(o){window.open("https://go.bkk.hu/route/BKK_"+o)},getStops:function(){0==Uker.Pt.Options.pton&&(Uker.mymap.isFullscreen()||Uker.fullscreenstate)||Uker.Map.mapOptions.zoom<15?(Uker.log.log("pton false"),Uker.Pt.setStops([])):$.getJSON(Uker.PtURL,{minLon:Uker.Map.mapOptions.west,minLat:Uker.Map.mapOptions.south,maxLon:Uker.Map.mapOptions.east,maxLat:Uker.Map.mapOptions.north,zoom:Uker.Map.mapOptions.zoom},(function(o){Uker.log.log(o);var e=[];for(stop in o){var p={};p.lon=o[stop].stop_lon,p.lat=o[stop].stop_lat,p.is_night_service=o[stop].is_night_service,p.group_id=o[stop].group_id,p.name=o[stop].stop_name,p.trip_headsign=o[stop].trip_headsign,p.routes=o[stop].routes,e.push(p)}Uker.Pt.setStops(e)}))},setRoutes:function(o){},computedroutes:function(){}},$((function(){Uker.Pt.init()})),$((function(){}));
//# sourceMappingURL=pt.js.map